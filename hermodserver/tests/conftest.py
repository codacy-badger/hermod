import pytest
from webtest import TestApp

from hermod.app import create_app, db as _db
from hermod.config import TestConfig

@pytest.yield_fixture(scope='function')
def db(app):
    """A database for the tests."""
    _db.app = app
    with app.app_context():
        _db.create_all()

    yield _db

    # Explicitly close DB connection
    _db.session.close()
    _db.drop_all()
